Здравствуйте!
Модуль "Ограничение продажи товаров" выполнен в рамках 4 схемы модулей.
Логика кода соответствует моей интерпретации ТЗ, но методы сервиса и хуков
постарался сделать пригодными для гибкой адаптации к смене логики аддона.
На данный момент, логика следующая: 
1. Wishlist: запрещено добавление, но если данный товар или группа товаров
   была в заказах, пользователь получает сообщение именно об этом,
2. Добавление в корзину товара, удовлетворяющего требованиям ТЗ, запрещено,
   если его режим модуля не 1 - "Разрешать все действия".

Функционально тестировать только выполнив вход под юзером (по ТЗ).
Был куплен товар с id = 222. http://additional-module/index.php?dispatch=products.view&product_id=222
Модуль легко адаптируем для работы с групповым добавлением товаров в корзину.
Спасибо! Хорошего дня!

Зарегистрированный пользователь:
Почта: 3535@gmail.com
Пароль: 80000

Админ:
Почта: pavelkotenev464@gmail.com
Пароль: admin